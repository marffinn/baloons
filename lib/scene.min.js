let camera,controls,scene,outscene,renderer,group_main,object;!1===WEBGL.isWebGLAvailable()&&document.body.appendChild(WEBGL.getWebGLErrorMessage());let rotationSpeed=0,current_model=0,manager=new THREE.LoadingManager,loader=new THREE.JSONLoader(manager),raycaster=new THREE.Raycaster,mouse=new THREE.Vector2,raycastArray=[],color=new THREE.Color(16777215),objectChosen=null,chosenArray={},cookieModel,size=260,divisions=8,gridHelper=new THREE.GridHelper(size,divisions),picturesUploaded=[],INTERSECTED;function init(){const color=16777215,near=20,far=4500;function startLoad(){$(".loadBar").css({width:"0%"})}function endLoad(){$(".loadBar").css({width:"0%",display:"none"}),linkInterpreter()}(scene=new THREE.Scene).fog=new THREE.Fog(color,20,far),scene.name="BALOONS_STAGE",window.scene=scene,(camera=new THREE.PerspectiveCamera(65,window.innerWidth/window.innerHeight,1,5e3)).position.x=150,camera.position.y=200,camera.position.z=150,camera.lookAt(scene.position),(renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0})).physicallyCorrectLights=!0,renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,renderer.gammaFactor=2.2,renderer.gammaOutPut=!0,renderer.setClearColor(0,0),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),(controls=new THREE.OrbitControls(camera,renderer.domElement)).dampingFactor=.1,controls.enableDamping=!0,controls.enablePan=!1,controls.minDistance=70,controls.maxDistance=1500,controls.maxPolarAngle=Math.PI/2,controls.addEventListener("change",render),manager.onStart=function(){startLoad()},manager.onProgress=function(item,loaded,total){let loadedBar=loaded/total*100,divi=loadedBar/100;$(".loadBar").css({width:loadedBar+"%"})},manager.onLoad=function(){endLoad()};let loader=new THREE.JSONLoader(manager);(group_main=new THREE.Group).name="Models",scene.add(group_main),group_help=new THREE.Group,group_help.name="Helper",scene.add(group_help),gridHelper.position.y=0,gridHelper.name="Grid Helper",group_help.add(gridHelper);let dudeMaterial=new THREE.MeshLambertMaterial({color:13421772,side:THREE.DoubleSide});loader.load("assets/DUDE/reference_dude.json",function(object){objectile=new THREE.Mesh(object,dudeMaterial),objectile.material.needsUpdate=!0,objectile.position.set(-85,0,85),objectile.scale.set(1,1,1),objectile.name="dudeReference",group_help.add(objectile)});let hemisphereLight=new THREE.HemisphereLight(16777215,16777215,.5);hemisphereLight.color.setHSL(.6,1,.95),hemisphereLight.groundColor.setHSL(.095,1,.75),hemisphereLight.position.set(0,0,500),hemisphereLight.name="Hemisphere Light",scene.add(hemisphereLight);let directionalLight=new THREE.DirectionalLight(16777215,.65);directionalLight.color.setHSL(.1,1,.95),directionalLight.position.set(100,20,100),directionalLight.name="Directional Light",scene.add(directionalLight);let directionalLight2=new THREE.DirectionalLight(16777215,.65);directionalLight2.color.setHSL(.1,1,.95),directionalLight2.position.set(-60,100,-60),directionalLight2.name="Directional Light 2",scene.add(directionalLight2),document.addEventListener("mousedown",onDocumentMouseDown,!1),document.addEventListener("mousemove",onDocumentMouseMove,!1),window.addEventListener("resize",onWindowResize,!1),$("#container").append(renderer.domElement)}function render(){renderer.render(scene,camera)}function animate(){group_main.rotation.y+=rotationSpeed,group_help.rotation.y+=rotationSpeed,requestAnimationFrame(animate),controls.update(),render()}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function removeGroupContents(){for(var i=group_main.children.length-1;i>=0;i--)group_main.remove(group_main.children[i])}function animIn(model_name){cookieModel=model_name,raycastArray=[],chosenArray={},removeGroupContents(),models[model_name].loadmodel(),Cookies.set(cookieModel,chosenArray,{expires:7})}function pan_hex(){$(".skolory a").each(function(){let box_color=$(this).attr("hex");$(this).css({"background-color":box_color})})}function onDocumentMouseDown(event){event.preventDefault(),$(".skolory a p").removeClass("mark"),mouse.x=event.clientX/renderer.domElement.width*2-1,mouse.y=-event.clientY/renderer.domElement.height*2+1,raycaster.setFromCamera(mouse,camera);let intersects=raycaster.intersectObjects(raycastArray);intersects.length>0&&(objectChosen=intersects[0].object.name,cR="#"+intersects[0].object.material.color.getHexString().toUpperCase(),$('[hex*="'+cR+'"] p').addClass("mark"))}function onDocumentMouseMove(event){event.preventDefault(),mouse.x=event.clientX/renderer.domElement.width*2-1,mouse.y=-event.clientY/renderer.domElement.height*2+1,raycaster.setFromCamera(mouse,camera);let intersects=raycaster.intersectObjects(raycastArray);intersects.length>0?($("html,body").css("cursor","pointer"),intersects[0].object!=INTERSECTED&&(INTERSECTED&&INTERSECTED.material.color.setHex(INTERSECTED.currentHex),(INTERSECTED=intersects[0].object).currentHex=INTERSECTED.material.color.getHex(),INTERSECTED.material.color.setHex(15787660))):($("html,body").css("cursor","default"),INTERSECTED&&INTERSECTED.material.color.setHex(INTERSECTED.currentHex),INTERSECTED=null)}init(),animate();let elem=document.documentElement;function openFullscreen(){elem.requestFullscreen?elem.requestFullscreen():elem.mozRequestFullScreen?elem.mozRequestFullScreen():elem.webkitRequestFullscreen?elem.webkitRequestFullscreen():elem.msRequestFullscreen&&elem.msRequestFullscreen()}function closeFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}$(".fullscreen_container").on("click",function(){let state;"on"==$(this).attr("state")?($(this).attr("state","off"),closeFullscreen()):($(this).attr("state","on"),openFullscreen())}),$("#modal p, #modalOrder p").on("click",function(){$("#modal, #modalOrder").fadeOut()}),$(".rotateRight").mousedown(function(){rotationSpeed=.02}).mouseup(function(){rotationSpeed=0}).mouseleave(function(){rotationSpeed=0}),$(".rotateLeft").mousedown(function(){rotationSpeed=-.02}).mouseup(function(){rotationSpeed=0}).mouseleave(function(){rotationSpeed=0}),"seen"!==Cookies.get("info")?$(".pickInfo").show():$(".pickInfo").hide(),$(".pickInfo p").on("click",function(){$(".pickInfo").fadeOut(),Cookies.set("info","seen",{expires:7})}),$(".info_container").on("click",function(){$(".pickInfo").fadeIn()}),$(".zoomIn").on("click",function(event){event.preventDefault(),controls.zoomIn()}),$(".zoomOut").on("click",function(event){event.preventDefault(),controls.zoomOut()}),$(".select i, .select h4").on("click",function(){$(this).parent().find(".listerFoldable").stop().slideToggle(100)});let centerSteering=function(){let steeringWidth=$(".steering").outerWidth();$(".steering").css({"margin-left":-steeringWidth/2})};$("input, textarea").on("click",function(){$(this).focus()}),$(".backToconfig, .placeOrder").on("click",function(){$(".pick, .order").slideToggle()}),$(".sagree i").on("click",function(){$(this).children("b").fadeToggle(200),$(".sendMail").toggleClass("sendDisable")}),$(".upload-box").dmUploader({url:"uploader/upload.php",onUploadSuccess:function(id,data){var response=JSON.stringify(data);let imager="baloons/"+data.path;chosenArray.logotype=imager,$("#modal").append(" Zdjęcie wgrano pomyślnie ").delay(2e3).fadeOut();let imgSRC='<p><img src="'+imager+'" /></p>';$(".inFileList").append(imgSRC),picturesUploaded.push(imgSRC),Cookies.set("x_picturesUploaded",imager,{expires:7}),console.log(imager)}}),pan_hex(),centerSteering();